---
alwaysApply: true
---

## File Structure

```
frontend/
├── src/
│   ├── app/
│   │   ├── api/
│   │   │   ├── agent-create/
│   │   │   │   ├── _tools/
│   │   │   │   │   ├── extract-facts-tools.ts
│   │   │   │   │   ├── generate-narration-tool.ts
│   │   │   │   │   └── save-student-info-tool.ts
│   │   │   │   ├── route.ts
│   │   │   │   └── session/
│   │   │   │       ├── upload-images/
│   │   │   │       │   └── route.ts
│   │   │   │       └── upload-pdf/
│   │   │   │           └── route.ts
│   │   │   ├── auth/
│   │   │   │   └── [...nextauth]/
│   │   │   │       └── route.ts
│   │   │   ├── trpc/
│   │   │   │   └── [trpc]/
│   │   │   │       └── route.ts
│   │   │   └── webhooks/
│   │   │       └── video-complete/
│   │   │           └── route.ts
│   │   ├── dashboard/
│   │   │   ├── admin/
│   │   │   │   └── assets/
│   │   │   │       └── page.tsx
│   │   │   ├── assets/
│   │   │   │   └── page.tsx
│   │   │   ├── create/
│   │   │   │   └── page.tsx
│   │   │   ├── editing/
│   │   │   │   └── [id]/
│   │   │   │       ├── editing-page-client.tsx
│   │   │   │       ├── layout.tsx
│   │   │   │       └── page.tsx
│   │   │   ├── history/
│   │   │   │   ├── [id]/
│   │   │   │   │   └── page.tsx
│   │   │   │   └── page.tsx
│   │   │   ├── layout-client.tsx
│   │   │   ├── layout.tsx
│   │   │   └── page.tsx
│   │   ├── error.tsx
│   │   ├── layout.tsx
│   │   ├── login/
│   │   │   └── page.tsx
│   │   ├── not-found.tsx
│   │   └── page.tsx
│   ├── components/
│   │   ├── agent-create/          # Agent creation interface
│   │   │   ├── agent-create-interface.tsx
│   │   │   ├── chat/
│   │   │   │   ├── chat-header.tsx
│   │   │   │   ├── chat-message-list.tsx
│   │   │   │   └── chat-welcome.tsx
│   │   │   ├── dialogs/
│   │   │   │   └── session-delete-dialog.tsx
│   │   │   ├── editors/
│   │   │   │   ├── document-editor.tsx
│   │   │   │   └── narration-editor.tsx
│   │   │   ├── hooks/
│   │   │   │   ├── use-session-management.ts
│   │   │   │   └── use-video-generation.ts
│   │   │   ├── loading/
│   │   │   │   ├── chat-loading-skeleton.tsx
│   │   │   │   └── editor-loading-skeleton.tsx
│   │   │   ├── prompts/
│   │   │   │   ├── fact-selection-prompt.tsx
│   │   │   │   └── narration-review-prompt.tsx
│   │   │   └── views/
│   │   │       ├── debug-view.tsx
│   │   │       ├── facts-view.tsx
│   │   │       └── video-view.tsx
│   │   ├── ai-elements/          # AI SDK components
│   │   ├── content/
│   │   │   ├── ContentActions.tsx
│   │   │   ├── ContentCard.tsx
│   │   │   ├── ContentFilters.tsx
│   │   │   ├── ContentGallery.tsx
│   │   │   ├── FinalVideoCard.tsx
│   │   │   ├── FinalVideosGallery.tsx
│   │   │   └── utils.ts
│   │   ├── generation/
│   │   │   ├── ImageGrid.tsx
│   │   │   ├── ProgressIndicator.tsx
│   │   │   ├── ScriptGenerationChainOfThought.tsx
│   │   │   └── VideoGrid.tsx
│   │   ├── landing/
│   │   │   ├── cta-section.tsx
│   │   │   ├── features.tsx
│   │   │   ├── footer.tsx
│   │   │   ├── header.tsx
│   │   │   ├── hero.tsx
│   │   │   ├── platform-compatibility.tsx
│   │   │   ├── trust-bar.tsx
│   │   │   └── video-interface.tsx
│   │   ├── layout/
│   │   │   ├── app-sidebar.tsx
│   │   │   ├── nav-user.tsx
│   │   │   ├── session-provider-wrapper.tsx
│   │   │   ├── theme-provider.tsx
│   │   │   ├── theme-toggle.tsx
│   │   │   └── user-sidebar.tsx
│   │   ├── login/
│   │   │   ├── auth-form.tsx
│   │   │   ├── google-signin-form.tsx
│   │   │   └── submit-button.tsx
│   │   ├── ui/                   # shadcn/ui components
│   │   └── video-editor/         # Video editing interface
│   │       ├── EditorLayout.tsx
│   │       ├── EditorSidebar.tsx
│   │       ├── ExportDialog.tsx
│   │       ├── MediaBin.tsx
│   │       ├── PreviewPlayer.tsx
│   │       ├── properties/
│   │       │   ├── MediaProperties.tsx
│   │       │   └── TextProperties.tsx
│   │       ├── PropertiesPanel.tsx
│   │       ├── remotion/
│   │       │   ├── Composition.tsx
│   │       │   └── sequences/
│   │       │       ├── AudioSequence.tsx
│   │       │       ├── ImageSequence.tsx
│   │       │       ├── TextSequence.tsx
│   │       │       └── VideoSequence.tsx
│   │       ├── theme.ts
│   │       ├── timeline/
│   │       │   ├── Playhead.tsx
│   │       │   ├── TimelineClip.tsx
│   │       │   ├── TimeRuler.tsx
│   │       │   └── Track.tsx
│   │       ├── Timeline.tsx
│   │       └── Toolbar.tsx
│   ├── hooks/
│   │   ├── use-mobile.ts
│   │   ├── useKeyboardShortcuts.ts
│   │   ├── useVideoSession.ts
│   │   └── useWebSocket.ts
│   ├── lib/
│   │   ├── api-response.ts
│   │   ├── api.ts
│   │   ├── auth-utils.ts
│   │   ├── extractPDF.ts
│   │   ├── logger.ts
│   │   ├── pdf-image-extractor.ts
│   │   ├── pdf-upload.ts
│   │   ├── pdfWorker.ts
│   │   └── utils.ts
│   ├── server/
│   │   ├── actions/
│   │   │   ├── auth.ts
│   │   │   ├── google-auth.ts
│   │   │   └── signout.ts
│   │   ├── agents/
│   │   │   ├── __tests__/
│   │   │   ├── fact-extraction.ts
│   │   │   └── narrative-builder.ts
│   │   ├── api/
│   │   │   ├── root.ts
│   │   │   ├── routers/
│   │   │   │   ├── error-reports.ts
│   │   │   │   ├── final-videos.ts
│   │   │   │   ├── script.ts
│   │   │   │   ├── session.ts
│   │   │   │   └── storage.ts
│   │   │   └── trpc.ts
│   │   ├── auth/
│   │   │   ├── config.ts
│   │   │   └── index.ts
│   │   ├── db/
│   │   │   ├── auth/
│   │   │   │   └── schema.ts
│   │   │   ├── error-reports/
│   │   │   │   └── schema.ts
│   │   │   ├── index.ts
│   │   │   ├── schema.ts
│   │   │   ├── video-generation/
│   │   │   │   └── schema.ts
│   │   │   └── webhooks/
│   │   │       └── schema.ts
│   │   ├── services/
│   │   │   ├── diagram-selector.ts
│   │   │   ├── pdf-storage.ts
│   │   │   └── storage.ts
│   │   └── utils/
│   │       ├── generate-script.ts
│   │       ├── message-utils.ts
│   │       └── session-utils.ts
│   ├── stores/
│   │   ├── agent-create-store.ts
│   │   └── editorStore.ts
│   ├── styles/
│   │   └── globals.css
│   ├── trpc/
│   │   ├── query-client.ts
│   │   ├── react.tsx
│   │   └── server.ts
│   ├── types/
│   │   ├── agent.ts
│   │   ├── chat.ts
│   │   ├── index.ts
│   │   └── storage.ts
│   ├── env.js
│   └── middleware.ts
├── public/
│   ├── favicon.ico
│   └── pdf.worker.min.mjs
├── scripts/
│   └── copy-pdf-worker.mjs
├── components.json
├── drizzle.config.ts
├── eslint.config.js
├── next.config.js
├── next-env.d.ts
├── package.json
├── postcss.config.js
├── prettier.config.js
├── tailwind.config.ts
├── tsconfig.json
└── .env.local.example
```

## Key Packages

### UI Framework & Core

- **next** (^16.0.3) - Next.js framework
- **react** (^19.2.0) - React library
- **react-dom** (^19.2.0) - React DOM renderer

### Styling

- **tailwindcss** (^4.0.15) - Utility-first CSS framework
- **@tailwindcss/postcss** (^4.0.15) - PostCSS plugin for Tailwind
- **shadcn** (^3.5.0) - UI component library
- **class-variance-authority** (^0.7.1) - Component variant management
- **clsx** (^2.1.1) - Conditional class names
- **tailwind-merge** (^3.4.0) - Merge Tailwind classes

### UI Components (Radix UI)

- **@radix-ui/react-\*** - Comprehensive set of accessible UI primitives
  - accordion, alert-dialog, aspect-ratio, avatar, checkbox, collapsible, context-menu, dialog, dropdown-menu, hover-card, label, menubar, navigation-menu, popover, progress, radio-group, scroll-area, select, separator, slider, slot, switch, tabs, toggle, toggle-group, tooltip, use-controllable-state, and more

### Material-UI (MUI)

- **@mui/material** (^7.3.5) - Material-UI component library
- **@mui/icons-material** (^7.3.5) - Material-UI icons
- **@mui/material-nextjs** (^7.3.5) - Next.js integration for MUI
- **@emotion/react** (^11.14.0) - CSS-in-JS library (MUI dependency)
- **@emotion/styled** (^11.14.1) - Styled components for Emotion
- **@emotion/cache** (^11.14.0) - Emotion cache utilities

### State Management & Data Fetching

- **zustand** (^5.0.8) - Lightweight state management
- **@tanstack/react-query** (^5.69.0) - Data fetching and caching
- **@trpc/client** (^11.0.0) - End-to-end typesafe APIs
- **@trpc/react-query** (^11.0.0) - tRPC React Query integration
- **@trpc/server** (^11.0.0) - tRPC server

### Authentication

- **next-auth** (5.0.0-beta.25) - Authentication for Next.js
- **@auth/drizzle-adapter** (^1.7.2) - Drizzle adapter for NextAuth
- **bcryptjs** (^3.0.3) - Password hashing

### Database

- **drizzle-orm** (^0.41.0) - TypeScript ORM
- **drizzle-kit** (^0.30.5) - Drizzle toolkit
- **postgres** (^3.4.4) - PostgreSQL client

### AI & ML

- **ai** (^5.0.93) - AI SDK for building AI applications
- **@ai-sdk/openai** (^2.0.68) - OpenAI SDK integration
- **@ai-sdk/react** (^2.0.93) - React hooks for AI SDK

### Video Processing & Editing

- **remotion** (^4.0.377) - Create videos programmatically with React
- **@remotion/player** (^4.0.377) - Remotion player component
- **react-moveable** (^0.56.0) - Draggable, resizable, scalable components
- **@scena/react-guides** (^0.28.2) - Ruler/guide components for editors

### Storage

- **@aws-sdk/client-s3** (^3.932.0) - AWS S3 client
- **@aws-sdk/s3-request-presigner** (^3.932.0) - S3 presigned URL generation

### Form Handling & Validation

- **react-hook-form** (^7.66.0) - Form state management
- **@hookform/resolvers** (^5.2.2) - Validation resolvers
- **zod** (^3.24.0) - Schema validation
- **react-day-picker** (^9.11.1) - Date picker component

### Utilities & Helpers

- **date-fns** (^4.1.0) - Date utility library
- **nanoid** (^5.1.6) - Unique ID generation
- **superjson** (^2.2.1) - JSON serialization
- **@t3-oss/env-nextjs** (^0.12.0) - Environment variable validation
- **lodash** (^4.17.21) - Utility library
- **server-only** (^0.0.1) - Mark modules as server-only

### PDF Processing

- **pdfjs-dist** (^5.4.394) - PDF.js library for PDF parsing

### UI Enhancements

- **lucide-react** (^0.553.0) - Icon library
- **motion** (^12.23.24) - Animation library
- **sonner** (^2.0.7) - Toast notifications
- **next-themes** (^0.4.6) - Theme management
- **recharts** (2.15.4) - Chart library
- **embla-carousel-react** (^8.6.0) - Carousel component
- **react-resizable-panels** (^3.0.6) - Resizable panel layouts
- **@xyflow/react** (^12.9.3) - Node-based flow diagrams
- **cmdk** (^1.1.1) - Command menu component
- **vaul** (^1.1.2) - Drawer component
- **shiki** (^3.15.0) - Syntax highlighting
- **input-otp** (^1.4.2) - OTP input component
- **use-stick-to-bottom** (^1.1.1) - Scroll to bottom hook
- **streamdown** (^1.5.0) - Streaming utilities
- **tokenlens** (^1.3.1) - Token utilities

### Development Tools

- **typescript** (^5.8.2) - TypeScript compiler
- **eslint** (^9.23.0) - Linting
- **eslint-config-next** (^15.2.3) - Next.js ESLint config
- **@eslint/eslintrc** (^3.3.1) - ESLint configuration utilities
- **prettier** (^3.5.3) - Code formatter
- **prettier-plugin-tailwindcss** (^0.6.11) - Tailwind Prettier plugin
- **typescript-eslint** (^8.27.0) - TypeScript ESLint rules
- **eslint-plugin-drizzle** (^0.2.3) - Drizzle ESLint plugin
- **tw-animate-css** (^1.4.0) - Tailwind animation utilities

## Global Rules

- Assume dev server is running; **do not** add scripts to start it.
- **No `any`**; strict TS; keep files **≤ 350 LoC**.
- **Types** in `/types`, **helpers** in `/lib`.
- **All inputs validated with Zod**; mutations **auth-guarded**.
- Workers/cron stay as **REST routes**; interactive UI uses **tRPC**.
- **Append-only facts** with `provenance` + `as_of`; user-visible data must show an as-of or source.
- Use **bun** only for frontend.
